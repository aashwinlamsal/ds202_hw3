---
title: "hw3_AashwinLamsal"
author: "Aashwin Lamsal"
date: "10/17/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Homework 3: NYC Flights Data
This data frame contains all 336,776 flights that departed from New York City in 2013. The data comes from the US Bureau of Transportation Statistics, and is documented in ?flights.

1) Find all flights that:
-Had an arrival delay of two or more hours
-Flew to Houston (IAH or HOU)
-Departed in summer (July, August, and September)
-Arrived more than two hours late, but didn’t leave late
-Were delayed by at least an hour, but made up over 30 minutes in flight

```{r}
library(tidyverse)
data(flights,package="nycflights13")
head(flights)

#flights that had an arrival delay of two or more hours
arrDelay2Hours <- filter(flights, arr_delay>=120)#since delay times are given in minutes
head(arrDelay2Hours, 10)

#flights that flew to Houston airports: IAH or HOU
houstonFlights <- filter(flights, dest == "IAH"|dest == "HOU")
head(houstonFlights, 10)

#flights that departed in the summer monthts: July, August, or September
summerFlights <- filter(flights, month == 7 | month == 8 | month == 9)
head(summerFlights, 10)

#flights that arrived more than 2 hours late, but did NOT leave late
arriveLateLeaveOnTime <- filter(flights, arr_delay>120 & dep_delay<=0)
head(arriveLateLeaveOnTime,10)

#flights that were delayed by AT LEAST an hour, but made up OVER 30 minutes in flight
makeUp30 <- filter(flights, dep_delay >= 60 & (dep_delay - arr_delay > 30)) # if departure delay is 10 minutes late, we expect arrival delay to be 10 minutes late as well
#but if arrival delay is -20 minutes, that means the flight caught up by 30 minutes in the air (10- (-20) = 30)
head(makeUp30, 10)
```
2) From lecture, our definition of cancelled flights (is.na(dep_delay) | is.na(arr_delay) ). This is not optimal. Why? Explain which is the most important column.
    -  The current definition of cancelled flights is not optimal because if there is
       an instance of NA values showing up in dep_delay, then there isn't a feasible 
       way for their to be a non-NA value in arr_delay, so having the conditional
       statement isn't optimal. This is why the dep_delay column is the most 
       important column between the two, since the dep_delay affects the arr_delay 
       column the most, ideally the arr_delay should be equally delayed as the 
       dep_delay (if your flight was delayed by 10 minutes, you would expect to arrive 10 minutes late).
       
       
3) What time of day should you fly if you want to avoid delays as much as possible?
```{r}
library(tidyverse)
library(ggplot2)
data(flights,package="nycflights13")
zeroDelays <- filter(flights, (dep_delay <= 0 & arr_delay <= 0))
timesWithNoDelay <- select(zeroDelays,hour, minute, time_hour, dep_delay)
head(timesWithNoDelay, 15)

ggplot(timesWithNoDelay, aes(hour, group = time_hour)) + geom_histogram() + labs(x = "Hours", y = "Frequency of Flights", title = "Distribution of Times for Flights With No Delays")


```
After the conditional statment used filtered the dataframe by about half of its original size. Sorting the dataframe by hour showed that most of the flight times where delays were avoided took place between 5 and 10 AM. There were times that had avoidable delays later on in the day. but they weren't as frequent (judging infrequency by time_hour to see the dates of the flights) as the early morning flights.

4) There are 4 other relational datasets in the nycflights13 package,
airlines gives information on the abbreviated airport codes,
airports gives info on each airport, identified by the faa airport code,
planes gives info on each plane, identified by its tailnum,
weather gives info on each NYC airport for each hour.

Loading the datasets...
```{r}
data(airlines,package='nycflights13')
data(airports,package='nycflights13')
data(planes,package='nycflights13')
data(weather,package='nycflights13')

```
After viewing the diagram, write out how the dataset flights connects to these 4 other datasets (there may be more than one variable that connects them). I’ll do the first one for you:

- flights connects to planes through a single variable, tailnum.